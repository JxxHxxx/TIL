
스레드 간 작업 전환을 컨텍스트 스위칭이라고 한다.  컨텍스트 스위칭은 오버헤드이다. 다음 예를 들으면 이해가 될 것이다.

스레드 A는 1부터 1억을 더하는 작업을 하고 스레드 B는 1부터 1억을 곱하는 작업을 한다.

스레드 A는 1부터 5천만까지 더하고 CPU 코어는 스레드 B에게 넘어갔다. 그리고 다시 스레드 A로 온다고 했을 때, 1부터 1억을 더하기 위해 CPU에서 사용했던 값들과 어디까지 더했는지 등의 작업 과정에 필요한 것들을 다시 불러와야 한다.

이러한 작업은 엄밀히 1부터 1억까지를 더하는 작업 외적인 것이다. 그래서 오버헤드라고 불린다. 그리고 컨텍스트 스위칭이 많을 수록 오버헤드가 커져 작업의 속도가 느려질 수 있다.



### CPU 바운드 작업 vs I/O 바운드 작업

CPU 코어 갯수에 비해 스레드가 작거나 동일하다면 아무래도 컨텍스트 스위칭이 적게 발생할 것이다. CPU 코어가 더 많기 때문이다.

그렇다면 CPU 코어 갯수에 스레드를 일치시켜야 할까? TOMCAT WAS 의 기본 스레드는 200개이다. 반면 코어가 200개가 넘는 서버가 흔한 것은 아니다.  참고로 우리집의 컴퓨터는 꽤나 비싸지만 물리적인 코어는 8개이다.

결론적으로 백앤드 개발자라면 I/O 바운드 작업이 많은 서버를 개발할 일이 잦다. 그리고 하나의 요청에는 하나의 스레드가 필요하다. 동시에 100명의 사용자의 요청이 오고 지연없이 처리하려면 100개의 스레드가 필요하다. 즉, I/O 바운드 작업이 필요한 서버라면 CPU 개수보다 월등히 스레드가 많이 구성되어야할 가능성이 높다.

*CPU 바운드 작업*
- CPU 연산 능력을 많이 요구하는 작업
- 계산, 데이터 처리, 알고리즘 실행
- 예시 : 복잡한 수학 연산, 데이터 분석, 비디오 인코딩

*I/O 바운드 작업*
- 디스크, 네트워크, 파일 시스템 등과 같은 입출력 작업을 많이 요구하는 작업
- I/O 작업이 완료될 때까지 대기 시간이 많이 발생, CPU는 상대적으로 유휴 상태에 있는 경우가 많다. 쉽게 스레드가 CPU를 사용하지 않고 I/O 작업이 완료될 대 까지 대기한다.
- 예시 데이터베이스 쿼리 처리, 파일 읽기/쓰기, 네트워크 통신, 사용자 입력 처리

