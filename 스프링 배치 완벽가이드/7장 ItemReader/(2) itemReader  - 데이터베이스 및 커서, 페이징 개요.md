
데이터베이스가 배치 처리에서 훌룡한 입력 소스인 데에는 몇 가지 이유가 있다.

- 데이터베이스에 내장된 트랜잭션 기능
- 다른 입력 포멧보다 뛰어난 복구 기능


##### JDBC
---
자바 진영에서 데이터베이스 연결, 통신은 JDBC를 통한다.  스프링 배치가 추가되면서 JDBC 기능에 배치 진영에서 요구되는 기능을 확장했다.

배치 처리를 할 때 대용량 데이터를 처리하는 요구 사항이 많다. 레코드 수백만 건을 반환하는 쿼리가 있다면 아마도 전체 데이터를 한 번에 메모리에 적재하고 싶지 않을 것이다.

하지만 스프링이 제공하는 `JdbcTemplate` 을 사용하면 전체 `ResultSet` 에서 한 로우씩 순서대로 가져오면서, 모든 로우를 필요한 도메인 객체로 변환해 메모리에 적재한다. 스프링 배치에서는 이에 대한 대안 2가지를 제시하고 있다.


##### 스프링 배치의 대안
---
스프링 배치에서는 한 번에 처리할 만큼의 레코드만 로딩하는 별도의 두 가지 기법을 제공한다.

- 커서(`cursor`)
- 페이징(`paging`)


*커서*

커서는 표준 `java.sql.ResultSet` 으로 구현된다. `ResultSet` 이 open 되면 `next()` 메서드를 호출할 때마다 데이터베이스에서 배치 레코드를 가져와 반환한다. 이렇게 하면 원하는 대로 데이터베이스에서 레코드를 스트리밍 받을 수 있으며 이는 커서 기법에 필요한 동작이다.

*페이징*

페이징의 개념은 데이터베이스에서 페이지라고 부르는 청크 크기 만큼의 레코드를 가져오는 것이다. 한 페이지의 레코드를 다 읽고 나면 새로운 쿼리를 사용해 데이터베이스에서 새 페이지를 읽어온다.

정리하면 이렇다.

*커서* : 레코드 1개씩 데이터베이스에서 읽어 `ItemReader` 로 가져온다.
*페이징* : 청크 단위 만큼 레코드를 데이터베이스에서 읽어 `ItemReader` 로 가져온다.


다음 장부터는 배치 작업을 *커서*, *페이징* 방식으로 처리하는 방법에 대해 정리하도록 하겠다.