32
자바스크립트는 비동기 처리를 위한 하나의 패턴으로 콜백 함수를 사용한다. 하지만 전통적인 콜백 패턴은 콜백 헬로 인해 가독성이 나쁘고 비동기 처리 중 발생한 에러의 처리가 곤란하며 여러 개의 비동기 처리를 한 번에 처리하는 데도 한계가 있다.

ES6에서는 비동기 처리를 위한 또 다른 패턴으로 프로미스를 도입했다. 프로미스는 전통적인 콜백 패턴이 가진 단점을 보완하며 비동기 처리 시점을 명확하게 표현할 수 있다는 장점이 있다.

##### 비동기 처리를 위한 콜백 패턴의 단점

##### 콜백 헬 및 응답
---


##### 에러 처리의 한계
---

에러는 호출자 방향으로 전파된다. 하지만 아래 예시에서는 `setTimeout` 함수로 에러가 전파된다. 하지만 에러는 `setTimeout` 함수의 콜백 함수에서 발생한다.

그리고 `setTimeout` 함수는 비동기 함수이다 . 그렇기 때문에 `setTimeout` 함수의 콜백 함수가 실행될 때는 `setTimout` 함수는 이미 콜스택에서 제거된 이후이다. 따라서 예외를 캐치하지 못한다.

```
try {
 setTimeout(() => { throw new Error('Error!');}, 1000);
} catch (e) {
	// 에러를 캐치하지 못한다.
	console.error('캐치한 에러', e)
}
```


아래와 같이 예외가 전파되는 쪽에서 try-catch 블록을 생성해야 예외를 캐치할 수 있다. 

```
try {
  setTimeout(() => {
    try {
      throw new Error('Error!');
    } catch (e) {
      console.error('캐치한 에러', e);
    }
  }, 1000);
} catch (e) {
  console.error('바깥의 캐치한 에러', e);
}
```